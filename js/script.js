var guns = [
	{
		id: 1,
		img:"./Images/Throwables/C4.png",
		name:"C4",
		price: 10000,
		category: "Throwables"
	},
	{
		id: 2,
		img:"./Images/Throwables/FlashBang.png",
		name:"FlashBang",
		price: 7000,
		category: "Throwables"
	},
	{
		id: 3,
		img:"./Images/Throwables/Grenade.png",
		name:"Grenade",
		price: 5000,
		category: "Throwables"
	},
	{
		id: 4,
		img:"./Images/Throwables/Molotov.png",
		name:"Molotov",
		price: 4000,
		category: "Throwables"
	},
	{
		id: 5,
		img:"./Images/Throwables/SmokeBomb.png",
		name:"SmokeBomb",
		price: 3000,
		category: "Throwables"
	},
	{
		id: 6,
		img:"./Images/Melee_Weapons/Cowbar.png",
		name:"Cowbar",
		price: 1000,
		category: "Melee Weapons"
	},
	{
		id: 7,
		img:"./Images/Melee_Weapons/Machete.png",
		name:"Machete",
		price: 1500,
		category: "Melee Weapons"
	},
	{
		id: 8,
		img:"./Images/Melee_Weapons/Pan.png",
		name:"Pan",
		price: 2000,
		category: "Melee Weapons"
	},
	{
		id: 9,
		img:"./Images/Melee_Weapons/Sickle.png",
		name:"Sickle",
		price: 2500,
		category: "Melee Weapons"
	},
	{
		id: 10,
		img:"./Images/Pistols/Flare_gun.png",
		name:"Flare Gun",
		price: 12000,
		category: "Pistol"
	},
	{
		id: 11,
		img:"./Images/Pistols/Deagle.png",
		name:"Deagle",
		price: 7000,
		category: "Pistol"
	},
	{
		id: 12,
		img:"./Images/Pistols/P92.png",
		name:"P92",
		price: 6500,
		category: "Pistol"
	},
	{
		id: 13,
		img:"./Images/Pistols/Skorpion.png",
		name:"Skorpion",
		price: 10000,
		category: "Pistol"
	},
	{
		id: 14,
		img:"./Images/Pistols/P18C.png",
		name:"P18C",
		price: 8000,
		category: "Pistol"
	},
	{
		id: 15,
		img:"./Images/Pistols/P1911.png",
		name:"P1911",
		price: 7000,
		category: "Pistol"
	},
	{
		id: 16,
		img:"./Images/Pistols/R45.png",
		name:"R45",
		price: 6500,
		category: "Pistol"
	},
	{
		id: 17,
		img:"./Images/Pistols/R1895.png",
		name:"R1895",
		price: 1500,
		category: "Pistol"
	},
	{
		id: 18,
		img:"./Images/Submachine_Guns/MP5K.png",
		name:"MP5K",
		price: 6000,
		category: "Submachine Guns"
	},
	{
		id: 19,
		img:"./Images/Submachine_Guns/PP-19.png",
		name:"PP-19",
		price: 6500,
		category: "Submachine Guns"
	},
	{
		id: 20,
		img:"./Images/Submachine_Guns/Thompson.png",
		name:"Thompson",
		price: 7500,
		category: "Submachine Guns"
	},
	{
		id: 21,
		img:"./Images/Submachine_Guns/UMP9.png",
		name:"UMP9",
		price: 10000,
		category: "Submachine Guns"
	},
	{
		id: 22,
		img:"./Images/Submachine_Guns/UZI.png",
		name:"UZI",
		price: 8000,
		category: "Submachine Guns"
	},
	{
		id: 23,
		img:"./Images/Submachine_Guns/Vector.png",
		name:"Vector",
		price: 9000,
		category: "Submachine Guns"
	},
	{
		id: 24,
		img:"./Images/Assault_Rifles/AKM.png",
		name:"AKM",
		price: 20000,
		category: "Assault Rifles"
	},
	{
		id: 25,
		img:"./Images/Assault_Rifles/AUG_A3.png",
		name:"AUG A3",
		price: 26000,
		category: "Assault Rifles"
	},
	{
		id: 26,
		img:"./Images/Assault_Rifles/G36C.png",
		name:"G36C",
		price: 30000,
		category: "Assault Rifles"
	},
	{
		id: 27,
		img:"./Images/Assault_Rifles/Groza.png",
		name:"Groza",
		price: 17000,
		category: "Assault Rifles"
	},
	{
		id: 28,
		img:"./Images/Assault_Rifles/M16A4.png",
		name:"M16A4",
		price: 28000,
		category: "Assault Rifles"
	},
	{
		id: 29,
		img:"./Images/Assault_Rifles/M416.png",
		name:"M416",
		price: 27000,
		category: "Assault Rifles"
	},
	{
		id: 30,
		img:"./Images/Assault_Rifles/M762.png",
		name:"M762",
		price: 19500,
		category: "Assault Rifles"
	},
	{
		id: 31,
		img:"./Images/Assault_Rifles/Mk47.png",
		name:"Mk47",
		price: 18500,
		category: "Assault Rifles"
	},
	{
		id: 32,
		img:"./Images/Assault_Rifles/QBZ95.png",
		name:"QBZ95",
		price: 16500,
		category: "Assault Rifles"
	},
	{
		id: 33,
		img:"./Images/Assault_Rifles/SCAR-L.png",
		name:"SCAR-L",
		price: 30000,
		category: "Assault Rifles"
	},
	{
		id: 34,
		img:"./Images/Designated_Marksman_Rifle/Mini.png",
		name:"Mini",
		price: 40000,
		category: "Designated Marksman Rifle"
	},
	{
		id: 35,
		img:"./Images/Designated_Marksman_Rifle/Mk14.png",
		name:"Mk14",
		price: 50000,
		category: "Designated Marksman Rifle"
	},
	{
		id: 36,
		img:"./Images/Designated_Marksman_Rifle/QBU.png",
		name:"QBU",
		price: 32000,
		category: "Designated Marksman Rifle"
	},
	{
		id: 37,
		img:"./Images/Designated_Marksman_Rifle/SKS.png",
		name:"SKS",
		price: 35000,
		category: "Designated Marksman Rifle"
	},
	{
		id: 38,
		img:"./Images/Designated_Marksman_Rifle/SLR.png",
		name:"SLR",
		price: 31000,
		category: "Designated Marksman Rifle"
	},
	{
		id: 39,
		img:"./Images/Designated_Marksman_Rifle/VSS.png",
		name:"VSS",
		price: 33000,
		category: "Designated Marksman Rifle"
	},
	{
		id: 40,
		img:"./Images/Light_Machine_Guns/DP.png",
		name:"DP",
		price: 50000,
		category: "Light Machine Guns"
	},
	{
		id: 41,
		img:"./Images/Light_Machine_Guns/M249.png",
		name:"M249",
		price: 46000,
		category: "Light Machine Guns"
	},
	{
		id: 42,
		img:"./Images/Snipers/AWM.png",
		name:"AWM",
		price: 90000,
		category: "Snipers"
	},
	{
		id: 43,
		img:"./Images/Snipers/Kar98k.png",
		name:"Kar98k",
		price: 75000,
		category: "Snipers"
	},
	{
		id: 44,
		img:"./Images/Snipers/M24.png",
		name:"M24",
		price: 68000,
		category: "Snipers"
	},
	{
		id: 45,
		img:"./Images/Snipers/Win94.png",
		name:"Win94",
		price: 55000,
		category: "Snipers"
	}	
];
//For groupby category value---------------------------------------------------------------------------------------------------------------------------------
function groupBy(xs, f) {
  return xs.reduce((r, v, i, a, k = f(v)) => ((r[k] || (r[k] = [])).push(v), r), {});
}

var Groupedproducts = groupBy(guns, function(c) {
	return c.category;
});

//For display all category checkbox----------------------------------------------------------------------------------------------------------------------
function displayAllCategory(){
	for (var category in Groupedproducts) {
	    if (Groupedproducts.hasOwnProperty(category)) {

	    	document.getElementById("cbForm").innerHTML += '<label class="cbLable"><input id="test" checked class="checkbox categorycheckbox" onclick="clickfu()" type="checkbox" value="'+ category +'" name="'+ category +'"> <p> '+ category +'</p><br></label>';
	    }
	}
}
//For display all products----------------------------------------------------------------------------------------------------------------------------------
function displayAllProducts(){
	for (var category in Groupedproducts) {
	    if (Groupedproducts.hasOwnProperty(category)) {

	    	document.getElementById('products-wraper').innerHTML += '<div class="inner-bg"><h1>'+ category +'</h1></div>';

	        for(a = 0; a < Groupedproducts[category].length ; a++){

		    	var img = Groupedproducts[category][a].img;
				var name = Groupedproducts[category][a].name;
				var price = Groupedproducts[category][a].price;
				var id = Groupedproducts[category][a].id;
				

				document.getElementById('products-wraper').innerHTML += '<div class="inner-item"> \
																			<div class="inner-item-wraper"> \
																				<div class="item-img">\
																					<img src="'+ img +'">\
																				</div>\
																				<div class="item-name">\
																					<h2 class="itemheading">'+ name +'</h2>\
																					<h2 class="itemprice"><span style="color:#cc4100;">&#x20b9;</span> '+ price +'</h2>\
																					<button type="button" class="addButton" id='+ id +' onclick="addToCart(this)">ADD</button>\
																				</div>	\
																			</div>\
																		</div>';
		    }
	        
	    }
	}
}

//Reaady Function-----	---------------------------------------------------------------------------------------------------------------------------------------
$(document).ready(function(){	

	displayAllCategory();

	
	displayAllProducts();
	
});

//For display all products-----------------------------------------------------------------------------------------------------------------------------------
function displayAllProducts(){
	for (var category in Groupedproducts) {
	    if (Groupedproducts.hasOwnProperty(category)) {

	    	document.getElementById('products-wraper').innerHTML += '<div class="inner-bg"><h1>'+ category +'</h1></div>';

	        productsrender(Groupedproducts[category]);        
	    }
	}
}

//For input checked-----------------------------------------------------------------------------------------------------------------------------------------

var categorycheckbox = document.getElementsByClassName('categorycheckbox');
//var addEvent = categorycheckbox.addEventListener ("click", clickfu);

	//$(".categorycheckbox").on ("click", clickf);

var onclickCheckboxFunction = document.getElementsByClassName("checkbox"); // <- this gives you  a HTMLCollection 
for (var i = 0; i < onclickCheckboxFunction.length; i++) {

	var b = onclickCheckboxFunction[i].addEvent;

}

//Checkbox Click Function----------------------------------------------------------------------------------------------------------------------------------

function clickfu(){
	
	var checkedcategory = [];

	for(i = 0; i < categorycheckbox.length ; i++){
		if(categorycheckbox[i].checked){
		  checkedcategory.push(categorycheckbox[i].value)
		}
	}

	document.getElementById('products-wraper').innerHTML = "";

	for(i = 0; i < checkedcategory.length; i++){				
		
		var checkedcatproductsarr = Groupedproducts[checkedcategory[i]];

		document.getElementById('products-wraper').innerHTML += '<div class="inner-bg"><h1>'+ checkedcategory[i] +'</h1></div>';

		productsrender(checkedcatproductsarr); 
	}

	if (checkedcategory == '') {
		document.getElementById('products-wraper').innerHTML="";

			displayAllProducts();
	}
}

// This is for looping products------------------------------------------------------------------------------------------------------------------------------
function productsrender(place){

	for(a = 0; a < place.length ; a++){

    	var img = place[a].img;
		var name = place[a].name;
		var price = place[a].price;
		var id = place[a].id;

		document.getElementById('products-wraper').innerHTML += '<div class="inner-item"> \
																	<div class="inner-item-wraper"> \
																		<div class="item-img">\
																			<img src="'+ img +'">\
																		</div>\
																		<div class="item-name">\
																			<h2 class="itemheading">'+ name +'</h2>\
																			<h2 class="itemprice"><span style="color:#cc4100;">&#x20b9;</span> '+ price +'</h2>\
																			<button type="button" class="addButton" id='+ id +' onclick="addToCart(this)">ADD</button>\
																		</div>	\
																	</div>\
																</div>';
    }     
}

//Search-----------------------------------------------------------------------------------------------------------------------------------------------------

document.getElementById ("search").addEventListener ("keyup", productsearch, false);


function productsearch(){

	document.getElementById('products-wraper').innerHTML = '';

	var searchinput = document.getElementById('search');
	var searchtext = searchinput.value.toUpperCase();
	var resultfound = false;

	for(i=0; i < guns.length; i++){

		var name = guns[i].name;
		var txtvalue = name;

		if (txtvalue.toUpperCase().indexOf(searchtext) > -1) {

			resultfound = true;
            
            document.getElementById('products-wraper').innerHTML += '<div class="inner-item"> \
																	<div class="inner-item-wraper"> \
																		<div class="item-img">\
																			<img src="'+ guns[i].img +'">\
																		</div>\
																		<div class="item-name">\
																			<h2 class="itemheading">'+ guns[i].name +'</h2>\
																			<h2 class="itemprice"><span style="color:#cc4100;">&#x20b9;</span> '+ guns[i].price +'</h2>\
																			<button type="button" class="addButton" id='+ guns[i].id +' onclick="addToCart(this)">ADD</button>\
																		</div>	\
																	</div>\
																</div>';
            
        }
	}

	//If Search value is empty----------------------------
	var empty = searchinput.value;
	if (empty === ""){

		document.getElementById('products-wraper').innerHTML="";

		displayAllProducts();
	}

	if (resultfound == false){
		document.getElementById('products-wraper').innerHTML = "<div class='notFoundText'><h1>Not Found</h1></div>";
	}
}

//Find the selected radio button-----------------------------------------------------------------------------------------------------------------------------

document.allradio.onclick = function(){
    var radioValue = document.allradio.filter.value;

    document.getElementById('products-wraper').innerHTML = "";

    if(radioValue =='category'){
	    rate_value = document.getElementById('r1').value;
	    displayAllProducts();

	}else if(radioValue =='ascending'){
	    rate_value = document.getElementById('r2').value;
	    ascending();

	}else if(radioValue =='descending'){
	    rate_value = document.getElementById('r3').value;
	    descending();

	}else if(radioValue =='highestPrice'){
	    rate_value = document.getElementById('r4').value;
	    highestPrice();

	}else if(radioValue =='lowestPrice'){
	    rate_value = document.getElementById('r5').value;
	    lowestPrice();

	}
}

//Radio button ascending order-------------------------------------------------------------------------------------------------------------------------------
function ascending(){

for(i=0; i < guns.length; i++){

	var name = guns[i].name;
	var txtvalue = name;

	//
	function compare(a, b){
		if ( a.name < b.name )
			return -1;
		if ( a.name > b.name )
			return 1;
	}
	guns.sort(compare);
	document.getElementById('products-wraper').innerHTML += '<div class="inner-item"> \
																<div class="inner-item-wraper"> \
																	<div class="item-img">\
																		<img src="'+ guns[i].img +'">\
																	</div>\
																	<div class="item-name">\
																		<h2 class="itemheading">'+ guns[i].name +'</h2>\
																		<h2 class="itemprice"><span style="color:#cc4100;">&#x20b9;</span> '+ guns[i].price +'</h2>\
																		<button type="button" class="addButton" id='+ guns[i].id +' onclick="addToCart(this)">ADD</button>\
																	</div>	\
																</div>\
															</div>';
	}	
}


//Radio button descending order-------------------------------------------------------------------------------------------------------------------------------
function descending(){

for(i=0; i < guns.length; i++){

	var name = guns[i].name;
	var txtvalue = name;

	//comparing lowest price to highest price 
	function compare(a, b){
		if ( a.name > b.name )
			return -1;
		if ( a.name < b.name )
			return 1;
	}
	guns.sort(compare);
	document.getElementById('products-wraper').innerHTML += '<div class="inner-item"> \
																<div class="inner-item-wraper"> \
																	<div class="item-img">\
																		<img src="'+ guns[i].img +'">\
																	</div>\
																	<div class="item-name">\
																		<h2 class="itemheading">'+ guns[i].name +'</h2>\
																		<h2 class="itemprice"><span style="color:#cc4100;">&#x20b9;</span> '+ guns[i].price +'</h2>\
																		<button type="button" class="addButton" id='+ guns[i].id +' onclick="addToCart(this)">ADD</button>\
																	</div>	\
																</div>\
															</div>';
	}	
}

//Radio button highest to lowest price-----------------------------------------------------------------------------------------------------------------------

function highestPrice(){

for(i=0; i < guns.length; i++){

	var price = guns[i].price;
	var txtvalue = price;

	//comparing highest price to lowest price
	function compare(a, b){
		return b.price - a.price
	}
	guns.sort(compare);
	document.getElementById('products-wraper').innerHTML += '<div class="inner-item"> \
																<div class="inner-item-wraper"> \
																	<div class="item-img">\
																		<img src="'+ guns[i].img +'">\
																	</div>\
																	<div class="item-name">\
																		<h2 class="itemheading">'+ guns[i].name +'</h2>\
																		<h2 class="itemprice"><span style="color:#cc4100;">&#x20b9;</span> '+ guns[i].price +'</h2>\
																		<button type="button" class="addButton" id='+ guns[i].id +' onclick="addToCart(this)">ADD</button>\
																	</div>	\
																</div>\
															</div>';
	}	
}

//Radio button lowest to highest price-----------------------------------------------------------------------------------------------------------------------

function lowestPrice(){

for(i=0; i < guns.length; i++){

	var price = guns[i].price;
	var txtvalue = price;

	function compare(a, b){
		return a.price - b.price
	}
	guns.sort(compare);
	document.getElementById('products-wraper').innerHTML += '<div class="inner-item"> \
																<div class="inner-item-wraper"> \
																	<div class="item-img">\
																		<img src="'+ guns[i].img +'">\
																	</div>\
																	<div class="item-name">\
																		<h2 class="itemheading">'+ guns[i].name +'</h2>\
																		<h2 class="itemprice"><span style="color:#cc4100;">&#x20b9;</span> '+ guns[i].price +'</h2>\
																		<button type="button" class="addButton" id='+ guns[i].id +' onclick="addToCart(this)">ADD</button>\
																	</div>	\
																</div>\
															</div>';
	}	
}


//ADD Button --------------------------------------------------------------------------------------------------------------------------------------------

function addToCart(selectedItems){

	var cartItems = localStorage.getItem('cartItems') || [];

	//If LocalStorage have more than one item
	if (cartItems.length > 0) {
		cartItems = JSON.parse(cartItems);
		// var length = cartItems.length;
		// console.log(length);
		// document.getElementById('cart').innerHTML = '<i class="fa fa-shopping-cart"></i><span class="badge">'+ length +'</span>';
	}

	for(i = 0; i < guns.length; i++){
		id = guns[i].id;

		//Inside the product list if product have a same id of selected procuct id 
		if(selectedItems.id == id){
			var img = guns[i].img;
			var name = guns[i].name;
			var price = guns[i].price;
			var quantity = 1;
			var itemExist = false;

			//LocalStorage have more than one item
			if (cartItems.length > 0) {
				for(j = 0; j < cartItems.length; j++){

					//If selected product id and localstorage id is same add quantity
					if(cartItems[j].id == selectedItems.id){
						itemExist = true;
						cartItems[j].quantity = cartItems[j].quantity + 1;
					}
				}
			}

			//Pushing selected products to localstorage
			if(itemExist == false){
				guns[i].quantity = quantity;
				cartItems.push(guns[i]);
			}
		}
	}

	document.getElementById('cart').innerHTML = '<i class="fa fa-shopping-cart"></i><span class="badge">'+ cartItems.length +'</span>';

	localStorage.setItem('cartItems', JSON.stringify(cartItems));
}

var getFromLocalStorage = localStorage.getItem('cartItems')
var parse = JSON.parse(getFromLocalStorage);
	if (parse == null) {
		document.getElementById('cart').innerHTML = '<i class="fa fa-shopping-cart"></i><span class="badge">0</span>';
	}
	if (parse) {
		for(i = 0; i < parse.length; i++){
		document.getElementById('cart').innerHTML = '<i class="fa fa-shopping-cart"></i><span class="badge">'+ parse.length +'</span>';
		}
	}
